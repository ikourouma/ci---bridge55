<!DOCTYPE html>
<html lang="en" data-country="pan-african">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BridgeWallet | Bridge55</title>
    <meta name="description" content="BridgeWallet demo: balance, top-ups, and transaction receipts." />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Jost:wght@500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/global-layout.css">

    <style>
        :root {
            --bg: #ffffff;
            --surface: #f6f9fc;
            --text: #0a2540;
            --muted: #425466;
            --border: rgba(0,0,0,0.08);
            --primary: #FF6B35;
            --primary-hover: #e85d2a;
        }

        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; color: var(--text); background: var(--bg); }
        h1, h2, h3, .brand-font { font-family: 'Jost', sans-serif; letter-spacing: -0.02em; }

        /* Sticky breadcrumb */
        .breadcrumb-bar {
            position: fixed;
            top: 64px;
            left: 0;
            right: 0;
            height: 40px;
            z-index: 999;
            background: linear-gradient(135deg, #0a2540 0%, #051b2e 100%);
            border-bottom: 1px solid rgba(255,255,255,0.10);
            display: flex;
            align-items: center;
            opacity: 0;
            transform: translateY(-6px);
            transition: all 0.25s ease;
            pointer-events: none;
        }
        .breadcrumb-bar.visible { opacity: 1; transform: translateY(0); pointer-events: auto; }
        .breadcrumb-inner {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.25rem;
            width: 100%;
            display: flex;
            align-items: center;
            gap: 0.6rem;
            color: rgba(255,255,255,0.9);
            font-size: 0.9rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .breadcrumb-link { color: rgba(255,255,255,0.9); text-decoration: none; display: inline-flex; align-items: center; gap: 0.45rem; }
        .breadcrumb-link:hover { color: #fff; text-decoration: underline; }
        .breadcrumb-sep { color: rgba(255,255,255,0.5); }
        .breadcrumb-current { display: inline-flex; align-items: center; gap: 0.45rem; color: #fff; font-weight: 900; flex: 1 1 auto; min-width: 0; overflow: hidden; text-overflow: ellipsis; }

        .hero {
            background: radial-gradient(900px 420px at 20% 20%, rgba(255,107,53,0.16), transparent 60%),
                        linear-gradient(135deg, #0a2540 0%, #051b2e 100%);
            color: #fff;
            padding: calc(2.0rem + 40px) 0 1.75rem;
            position: relative;
            overflow: hidden;
        }
        .hero::before {
            content: "";
            position: absolute;
            inset: 0;
            background: url("https://images.unsplash.com/photo-1526304640581-d334cdbbf45e?auto=format&fit=crop&w=2000&q=80") center/cover;
            opacity: 0.12;
        }
        .hero .hero-inner { position: relative; z-index: 1; }
        .hero-title { font-size: clamp(1.8rem, 3.2vw, 2.5rem); font-weight: 900; margin: 0.6rem 0 0.35rem; }
        .hero-sub { color: rgba(255,255,255,0.84); max-width: 900px; margin: 0; }

        .section { padding: 2rem 0; }
        .panel {
            background: #fff;
            border: 1px solid rgba(0,0,0,0.08);
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            overflow: hidden;
        }
        .panel-header {
            padding: 1rem 1.1rem;
            border-bottom: 1px solid rgba(0,0,0,0.06);
            background: linear-gradient(135deg, rgba(255,107,53,0.08), rgba(0,78,137,0.06));
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }
        .panel-title { font-weight: 900; margin: 0; }
        .panel-body { padding: 1.1rem; }

        .kpi {
            display: inline-flex;
            align-items: center;
            gap: 0.45rem;
            padding: 0.35rem 0.7rem;
            border-radius: 999px;
            border: 1px solid rgba(0,0,0,0.08);
            background: rgba(255,255,255,0.8);
            font-weight: 900;
            color: #0a2540;
            white-space: nowrap;
        }

        .btn-primary-b55 {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-hover) 100%);
            border: none;
            color: #fff;
            padding: 0.7rem 0.95rem;
            border-radius: 12px;
            font-weight: 900;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }
        .btn-ghost-b55 {
            border: 1px solid rgba(0,0,0,0.10);
            color: #0a2540;
            background: rgba(255,255,255,0.8);
            padding: 0.7rem 0.95rem;
            border-radius: 12px;
            font-weight: 900;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }
        .btn-ghost-b55:hover { border-color: rgba(255,107,53,0.55); }

        .table-wrap { overflow-x: auto; border-radius: 14px; border: 1px solid rgba(0,0,0,0.08); }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 0.85rem; border-bottom: 1px solid rgba(0,0,0,0.06); vertical-align: top; }
        th { color: rgba(10,37,64,0.70); font-size: 0.78rem; text-transform: uppercase; letter-spacing: 0.5px; background: rgba(0,0,0,0.02); }
        td { color: rgba(10,37,64,0.95); font-weight: 650; }
        tr:hover td { background: rgba(255,107,53,0.04); }
        .muted { color: var(--muted); font-weight: 650; }
        .credit { color: #166534; font-weight: 900; }
        .debit { color: #b91c1c; font-weight: 900; }
        .badgex {
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.25rem 0.6rem;
            border-radius: 999px;
            border: 1px solid rgba(0,0,0,0.08);
            background: rgba(255,255,255,0.8);
            font-weight: 900;
            font-size: 0.8rem;
            white-space: nowrap;
        }
        .badgex.ticket { border-color: rgba(255,107,53,0.35); }
        .badgex.topup { border-color: rgba(34,197,94,0.35); }
        .highlight {
            outline: 2px solid rgba(34,197,94,0.45);
            outline-offset: -2px;
        }
    </style>
</head>
<body>
    <nav class="breadcrumb-bar" id="breadcrumbBar" aria-label="Breadcrumb">
        <div class="breadcrumb-inner">
            <a href="../index.html" class="breadcrumb-link">
                <i class="fa-solid fa-house"></i>
                <span>Home</span>
            </a>
            <span class="breadcrumb-sep"><i class="fa-solid fa-chevron-right"></i></span>
            <span class="breadcrumb-current">
                <i class="fa-solid fa-wallet"></i>
                <span>BridgeWallet</span>
            </span>
        </div>
    </nav>

    <div id="global-header"></div>

    <section class="hero">
        <div class="hero-inner bridge-container">
            <div class="d-flex flex-wrap gap-2 align-items-center">
                <span class="kpi"><i class="fa-solid fa-receipt"></i> Receipts stored</span>
                <span class="kpi"><i class="fa-solid fa-shield-check"></i> Refund-to-wallet ready</span>
                <span class="kpi"><i class="fa-solid fa-bolt"></i> Demo ledger</span>
            </div>
            <h1 class="hero-title">BridgeWallet</h1>
            <p class="hero-sub">Balance, top-ups, and your AfCON ticket receipts.</p>
        </div>
    </section>

    <main class="section">
        <div class="bridge-container">
            <div class="row g-4">
                <div class="col-lg-4">
                    <div class="panel">
                        <div class="panel-header">
                            <div class="panel-title">Balance</div>
                            <div class="kpi" id="balancePill"><i class="fa-solid fa-wallet"></i> $0.00</div>
                        </div>
                        <div class="panel-body">
                            <div class="d-flex gap-2 flex-wrap">
                                <button class="btn-ghost-b55" type="button" onclick="topUp(25)"><i class="fa-solid fa-plus"></i> Top up $25</button>
                                <button class="btn-ghost-b55" type="button" onclick="topUp(50)"><i class="fa-solid fa-plus"></i> Top up $50</button>
                                <button class="btn-ghost-b55" type="button" onclick="topUp(100)"><i class="fa-solid fa-plus"></i> Top up $100</button>
                            </div>
                            <hr />
                            <div class="d-flex gap-2 flex-wrap">
                                <a class="btn-primary-b55" href="../pages/afcon.html"><i class="fa-solid fa-trophy"></i> Back to AfCON</a>
                                <button class="btn-ghost-b55" type="button" onclick="clearWallet()"><i class="fa-solid fa-broom"></i> Clear demo</button>
                            </div>
                            <div class="muted mt-3" id="walletMsg" style="display:none;"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-8">
                    <div class="panel">
                        <div class="panel-header">
                            <div class="panel-title">Transactions</div>
                            <div class="kpi"><i class="fa-solid fa-list"></i> Ledger</div>
                        </div>
                        <div class="panel-body">
                            <div class="table-wrap">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>Type</th>
                                            <th>Label</th>
                                            <th>Date</th>
                                            <th>Amount</th>
                                            <th>Receipt</th>
                                        </tr>
                                    </thead>
                                    <tbody id="ledgerBody"></tbody>
                                </table>
                            </div>
                            <div class="muted mt-3 small">
                                This is a demo ledger (localStorage). In production, this would be a secure, auditable wallet ledger with reconciliation and refunds.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div id="global-footer"></div>

    <script>
        const WALLET_BAL_KEY = 'bridge55-wallet-balance';
        const WALLET_LEDGER_KEY = 'bridge55-wallet-ledger';

        // Sticky breadcrumb reveal
        const breadcrumbBar = document.getElementById('breadcrumbBar');
        window.addEventListener('scroll', () => {
            if (!breadcrumbBar) return;
            breadcrumbBar.classList.toggle('visible', window.scrollY > 120);
        });

        function safeParse(json) { try { return JSON.parse(json); } catch { return null; } }
        function getParam(name) {
            try { return new URLSearchParams(window.location.search).get(name); }
            catch { return null; }
        }

        function fmtMoney(v) { return `$${v.toFixed(2)}`; }

        function getBalance() {
            try {
                const v = Number(localStorage.getItem(WALLET_BAL_KEY));
                if (Number.isFinite(v)) return v;
                localStorage.setItem(WALLET_BAL_KEY, String(75));
                return 75;
            } catch { return 75; }
        }
        function setBalance(v) { try { localStorage.setItem(WALLET_BAL_KEY, String(v)); } catch {} }
        function getLedger() {
            try {
                const raw = localStorage.getItem(WALLET_LEDGER_KEY);
                const parsed = raw ? safeParse(raw) : null;
                if (Array.isArray(parsed)) return parsed;
                localStorage.setItem(WALLET_LEDGER_KEY, JSON.stringify([]));
                return [];
            } catch { return []; }
        }
        function setLedger(arr) { try { localStorage.setItem(WALLET_LEDGER_KEY, JSON.stringify(arr)); } catch {} }

        function addLedgerTx(tx) {
            const ledger = getLedger();
            ledger.unshift(tx);
            setLedger(ledger);
        }

        function showMsg(msg, kind = 'muted') {
            const el = document.getElementById('walletMsg');
            if (!el) return;
            el.style.display = 'block';
            el.style.color = (kind === 'error') ? '#b91c1c' : (kind === 'success') ? '#166534' : '#425466';
            el.textContent = msg;
        }

        function render() {
            const bal = getBalance();
            const pill = document.getElementById('balancePill');
            if (pill) pill.innerHTML = `<i class="fa-solid fa-wallet"></i> ${fmtMoney(bal)}`;

            const receiptHighlight = getParam('receipt');
            const ledger = getLedger();
            const tbody = document.getElementById('ledgerBody');
            if (!tbody) return;
            if (!ledger.length) {
                tbody.innerHTML = `<tr><td colspan="5" class="muted">No transactions yet. Buy an AfCON ticket to generate a receipt.</td></tr>`;
                return;
            }
            tbody.innerHTML = ledger.map(tx => {
                const isCredit = (tx.amount || 0) > 0;
                const amtClass = isCredit ? 'credit' : 'debit';
                const typeBadge = (tx.type === 'ticket')
                    ? `<span class="badgex ticket"><i class="fa-solid fa-ticket"></i> Ticket</span>`
                    : `<span class="badgex topup"><i class="fa-solid fa-plus"></i> Top-up</span>`;
                const d = tx.ts ? new Date(tx.ts).toLocaleString() : '—';
                const receipt = tx.id || '—';
                const highlight = (receiptHighlight && String(receiptHighlight) === String(receipt)) ? 'highlight' : '';
                return `
                    <tr class="${highlight}">
                        <td>${typeBadge}</td>
                        <td>${tx.label || '—'}</td>
                        <td class="muted">${d}</td>
                        <td class="${amtClass}">${fmtMoney(Math.abs(tx.amount || 0))}${isCredit ? '' : ''}</td>
                        <td class="muted" style="font-weight:900;">${receipt}</td>
                    </tr>
                `;
            }).join('');
        }

        function topUp(amount) {
            const bal = getBalance();
            const next = bal + amount;
            setBalance(next);
            addLedgerTx({
                id: `topup-${Date.now()}`,
                type: 'topup',
                amount: amount,
                currency: 'USD',
                ts: new Date().toISOString(),
                label: `Wallet top-up`,
                meta: { method: 'demo' }
            });
            showMsg(`Top-up successful: +${fmtMoney(amount)}.`, 'success');
            render();
        }

        function clearWallet() {
            if (!confirm('Clear demo wallet balance + ledger?')) return;
            setBalance(75);
            setLedger([]);
            showMsg('Demo wallet cleared.', 'muted');
            render();
        }

        document.addEventListener('DOMContentLoaded', () => {
            render();

            // Load global header/footer
            fetch('../components/global-header.html')
                .then(r => r.text())
                .then(html => {
                    const c = document.getElementById('global-header');
                    c.innerHTML = html;
                    c.querySelectorAll('script').forEach(oldScript => {
                        const s = document.createElement('script');
                        Array.from(oldScript.attributes).forEach(a => s.setAttribute(a.name, a.value));
                        s.textContent = oldScript.textContent;
                        oldScript.parentNode.replaceChild(s, oldScript);
                    });
                })
                .catch(err => console.log('Header not loaded:', err));

            fetch('../components/global-footer.html')
                .then(r => r.text())
                .then(html => { document.getElementById('global-footer').innerHTML = html; })
                .catch(err => console.log('Footer not loaded:', err));
        });
    </script>
</body>
</html>








